import torch
import numpy as np
import math
import torch.nn as nn

def sigmoid(x):
    return 1 / (1 + math.exp(-x))

m = nn.Sigmoid()

a = torch.tensor([[[322.2437, 130.7243],
         [320.3309, 133.5626],
         [311.9167, 109.0553],
         [323.1711, 126.5729],
         [312.4806, 123.2234],
         [330.7293, 125.3739],
         [295.6910, 118.1626],
         [311.4402, 110.4352]],
        [[317.5956, 129.4126],
         [328.8334, 135.6843],
         [321.0048, 110.8366],
         [328.0595, 127.8765],
         [317.1084, 124.4049],
         [339.0965, 127.1849],
         [296.1642, 118.3282],
         [320.5598, 112.2766]],
        [[309.4964, 126.9609],
         [338.2485, 138.0974],
         [331.3365, 113.1250],
         [335.8382, 129.9329],
         [324.7467, 126.4109],
         [348.4090, 129.3525],
         [296.4305, 118.4165],
         [330.9445, 114.6101]],
        [[299.2831, 124.1186],
         [348.0896, 140.7068],
         [342.1789, 115.6906],
         [345.0956, 132.2248],
         [333.9483, 128.6713],
         [358.2353, 131.7755],
         [296.4828, 118.4741],
         [341.8239, 117.2119]],
        [[288.0623, 121.2144],
         [358.1720, 143.4567],
         [353.2009, 118.4326],
         [355.0546, 134.6462],
         [343.8867, 131.0618],
         [368.3850, 134.3881],
         [296.3613, 118.5222],
         [352.8642, 119.9828]],
        [[276.4434, 118.2746],
         [368.3721, 146.2961],
         [364.2464, 121.2911],
         [365.3750, 137.1781],
         [354.2018, 133.5641],
         [378.7090, 137.1271],
         [296.1020, 118.5712],
         [363.9132, 122.8644]]])

distance = []
for a, b in zip(a[:, :], a[1:, :]):
    dist = torch.pairwise_distance(a, b)
    dist = dist.detach().numpy()
    dist = dist.reshape(1, -1)
    distance.append(dist)

distance = np.concatenate(distance, axis=0)
#print(distance)

distance = torch.from_numpy(distance).type(torch.float)
speed = distance/0.5
speed = m(speed/10)
print(speed)
column = speed.size(1)
for i in range(0, column):
    print(torch.mean(speed[:, i]))
