import torch
import numpy as np
import math
import torch.nn as nn

def sigmoid(x):
    return 1 / (1 + math.exp(-x))

m = nn.Sigmoid()

a = torch.tensor([[[1865.5398,  474.6725],
         [1884.8883,  490.0180]],
        [[1865.0020,  474.3604],
         [1884.3246,  489.6800]],
        [[1864.4918,  474.0976],
         [1883.8029,  489.3961]],
        [[1864.0299,  473.9022],
         [1883.3265,  489.1602]],
        [[1863.5929,  473.7421],
         [1882.8838,  488.9553]],
        [[1863.1813,  473.6109],
         [1882.4711,  488.7749]],
        [[1862.7915,  473.5006],
         [1882.0842,  488.6138]],
        [[1862.4224,  473.4073],
         [1881.7205,  488.4690]],
        [[1862.0723,  473.3276],
         [1881.3771,  488.3380]],
        [[1861.7399,  473.2593],
         [1881.0524,  488.2191]],
        [[1861.4241,  473.2007],
         [1880.7445,  488.1106]],
        [[1861.1238,  473.1503],
         [1880.4524,  488.0113]],
        [[1860.8381,  473.1072],
         [1880.1748,  487.9203]],
        [[1860.5662,  473.0704],
         [1879.9109,  487.8366]],
        [[1860.3073,  473.0392],
         [1879.6599,  487.7595]],
        [[1860.0607,  473.0130],
         [1879.4213,  487.6883]],
        [[1859.8258,  472.9913],
         [1879.1942,  487.6224]],
        [[1859.6022,  472.9737],
         [1878.9781,  487.5613]],
        [[1859.3892,  472.9598],
         [1878.7727,  487.5045]],
        [[1859.1863,  472.9493],
         [1878.5773,  487.4517]],
        [[1858.9932,  472.9418],
         [1878.3915,  487.4023]],
        [[1858.8093,  472.9371],
         [1878.2148,  487.3563]],
        [[1858.6343,  472.9350],
         [1878.0469,  487.3130]],
        [[1858.4678,  472.9352],
         [1877.8873,  487.2725]],
        [[1858.3092,  472.9377],
         [1877.7358,  487.2343]],
        [[1858.1584,  472.9421],
         [1877.5918,  487.1984]],
        [[1858.0150,  472.9483],
         [1877.4551,  487.1644]],
        [[1857.8787,  472.9562],
         [1877.3253,  487.1321]],
        [[1857.7489,  472.9658],
         [1877.2021,  487.1015]],
        [[1857.6255,  472.9767],
         [1877.0852,  487.0724]]])

distance = []
for a, b in zip(a[:, :], a[1:, :]):
    dist = torch.pairwise_distance(a, b)
    dist = dist.detach().numpy()
    dist = dist.reshape(1, -1)
    distance.append(dist)

distance = np.concatenate(distance, axis=0)
#print(distance)

distance = torch.from_numpy(distance).type(torch.float)
#speed = distance / 0.4
speed = distance
print(torch.sigmoid(speed))


