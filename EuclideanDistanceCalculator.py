import torch
import numpy as np
import math
import torch.nn as nn

def sigmoid(x):
    return 1 / (1 + math.exp(-x))

m = nn.Sigmoid()

a = torch.tensor([[[2010.1052,  590.4616],
         [2023.7050,  601.0327],
         [1998.8270,  581.2569],
         [2007.0118,  592.2701],
         [1991.6998,  603.3309]],
        [[2009.5632,  590.1130],
         [2023.1969,  600.6216],
         [1998.2297,  580.8640],
         [2006.9756,  592.2654],
         [1991.7874,  603.3456]],
        [[2009.0570,  589.8018],
         [2022.6692,  600.1837],
         [1997.6550,  580.5239],
         [2006.9830,  592.3294],
         [1991.9257,  603.4340]],
        [[2008.5924,  589.5301],
         [2022.1307,  599.7095],
         [1997.1187,  580.2292],
         [2007.0212,  592.4186],
         [1992.1079,  603.5592]],
        [[2008.1617,  589.2851],
         [2021.5724,  599.1887],
         [1996.6113,  579.9586],
         [2007.0883,  592.5269],
         [1992.3330,  603.7152]],
        [[2007.7593,  589.0615],
         [2020.9889,  598.6216],
         [1996.1273,  579.7065],
         [2007.1819,  592.6548],
         [1992.6002,  603.9044]],
        [[2007.3807,  588.8553],
         [2020.3774,  598.0101],
         [1995.6626,  579.4690],
         [2007.3008,  592.8060],
         [1992.9104,  604.1325]],
        [[2007.0228,  588.6639],
         [2019.7373,  597.3562],
         [1995.2145,  579.2435],
         [2007.4454,  592.9852],
         [1993.2654,  604.4066]],
        [[2006.6831,  588.4849],
         [2019.0687,  596.6626],
         [1994.7815,  579.0286],
         [2007.6169,  593.1979],
         [1993.6678,  604.7339]],
        [[2006.3596,  588.3167],
         [2018.3724,  595.9320],
         [1994.3624,  578.8226],
         [2007.8173,  593.4503],
         [1994.1204,  605.1213]],
        [[2006.0509,  588.1577],
         [2017.6498,  595.1674],
         [1993.9567,  578.6248],
         [2008.0491,  593.7491],
         [1994.6254,  605.5750]],
        [[2005.7557,  588.0067],
         [2016.9021,  594.3714],
         [1993.5632,  578.4341],
         [2008.3152,  594.1019],
         [1995.1848,  606.0992]],
        [[2005.4731,  587.8628],
         [2016.1306,  593.5468],
         [1993.1819,  578.2498],
         [2008.6190,  594.5165],
         [1995.7997,  606.6962]],
        [[2005.2021,  587.7252],
         [2015.3372,  592.6959],
         [1992.8120,  578.0714],
         [2008.9636,  595.0006],
         [1996.4696,  607.3658]],
        [[2004.9420,  587.5933],
         [2014.5229,  591.8212],
         [1992.4531,  577.8984],
         [2009.3521,  595.5609],
         [1997.1936,  608.1053]],
        [[2004.6921,  587.4664],
         [2013.6898,  590.9244],
         [1992.1047,  577.7303],
         [2009.7867,  596.2025],
         [1997.9697,  608.9096]],
        [[2004.4520,  587.3441],
         [2012.8389,  590.0076],
         [1991.7666,  577.5668],
         [2010.2695,  596.9282],
         [1998.7957,  609.7726]],
        [[2004.2212,  587.2261],
         [2011.9717,  589.0723],
         [1991.4384,  577.4076],
         [2010.8015,  597.7375],
         [1999.6686,  610.6874]],
        [[2003.9989,  587.1120],
         [2011.0896,  588.1198],
         [1991.1196,  577.2525],
         [2011.3831,  598.6277],
         [2000.5856,  611.6472]],
        [[2003.7850,  587.0016],
         [2010.1938,  587.1514],
         [1990.8101,  577.1012],
         [2012.0135,  599.5928],
         [2001.5439,  612.6454]],
        [[2003.5790,  586.8945],
         [2009.2854,  586.1682],
         [1990.5094,  576.9536],
         [2012.6924,  600.6254],
         [2002.5406,  613.6763]],
        [[2003.3806,  586.7908],
         [2008.3655,  585.1709],
         [1990.2175,  576.8094],
         [2013.4183,  601.7170],
         [2003.5732,  614.7349]],
        [[2003.1893,  586.6900],
         [2007.4351,  584.1605],
         [1989.9338,  576.6686],
         [2014.1903,  602.8585],
         [2004.6388,  615.8168]],
        [[2003.0050,  586.5920],
         [2006.4949,  583.1376],
         [1989.6584,  576.5310],
         [2015.0067,  604.0409],
         [2005.7347,  616.9186]],
        [[2002.8271,  586.4969],
         [2005.5458,  582.1028],
         [1989.3909,  576.3965],
         [2015.8665,  605.2560],
         [2006.8589,  618.0372]],
        [[2002.6558,  586.4042],
         [2004.5885,  581.0568],
         [1989.1309,  576.2650],
         [2016.7681,  606.4962],
         [2008.0088,  619.1703]],
        [[2002.4902,  586.3140],
         [2003.6237,  580.0000],
         [1988.8784,  576.1364],
         [2017.7102,  607.7546],
         [2009.1824,  620.3159]],
        [[2002.3306,  586.2262],
         [2002.6519,  578.9328],
         [1988.6331,  576.0106],
         [2018.6915,  609.0258],
         [2010.3777,  621.4722]],
        [[2002.1764,  586.1406],
         [2001.6737,  577.8557],
         [1988.3948,  575.8875],
         [2019.7103,  610.3048],
         [2011.5927,  622.6380]],
        [[2002.0276,  586.0571],
         [2000.6897,  576.7690],
         [1988.1633,  575.7671],
         [2020.7650,  611.5881],
         [2012.8257,  623.8121]],
        [[2001.8838,  585.9756],
         [1999.7002,  575.6731],
         [1987.9384,  575.6493],
         [2021.8538,  612.8730],
         [2014.0753,  624.9936]],
        [[2001.7449,  585.8961],
         [1998.7056,  574.5683],
         [1987.7200,  575.5341],
         [2022.9745,  614.1573],
         [2015.3398,  626.1817]],
        [[2001.6106,  585.8184],
         [1997.7063,  573.4550],
         [1987.5077,  575.4213],
         [2024.1252,  615.4399],
         [2016.6182,  627.3757]],
        [[2001.4807,  585.7426],
         [1996.7028,  572.3335],
         [1987.3014,  575.3110],
         [2025.3037,  616.7199],
         [2017.9091,  628.5750]],
        [[2001.3551,  585.6684],
         [1995.6953,  571.2040],
         [1987.1011,  575.2031],
         [2026.5077,  617.9971],
         [2019.2112,  629.7791]],
        [[2001.2336,  585.5958],
         [1994.6841,  570.0669],
         [1986.9065,  575.0975],
         [2027.7349,  619.2712],
         [2020.5238,  630.9877]],
        [[2001.1161,  585.5248],
         [1993.6694,  568.9224],
         [1986.7174,  574.9942],
         [2028.9830,  620.5425],
         [2021.8459,  632.2003]],
        [[2001.0023,  585.4554],
         [1992.6516,  567.7708],
         [1986.5337,  574.8932],
         [2030.2502,  621.8110],
         [2023.1766,  633.4164]],
        [[2000.8921,  585.3873],
         [1991.6310,  566.6123],
         [1986.3552,  574.7945],
         [2031.5344,  623.0771],
         [2024.5154,  634.6361]],
        [[2000.7854,  585.3206],
         [1990.6075,  565.4472],
         [1986.1818,  574.6979],
         [2032.8337,  624.3411],
         [2025.8612,  635.8588]],
        [[2000.6820,  585.2552],
         [1989.5818,  564.2758],
         [1986.0133,  574.6036],
         [2034.1467,  625.6032],
         [2027.2137,  637.0844]],
        [[2000.5817,  585.1911],
         [1988.5536,  563.0982],
         [1985.8496,  574.5114],
         [2035.4717,  626.8637],
         [2028.5723,  638.3127]],
        [[2000.4845,  585.1282],
         [1987.5233,  561.9147],
         [1985.6906,  574.4212],
         [2036.8073,  628.1229],
         [2029.9364,  639.5435]],
        [[2000.3901,  585.0665],
         [1986.4911,  560.7256],
         [1985.5360,  574.3331],
         [2038.1523,  629.3809],
         [2031.3055,  640.7765]],
        [[2000.2986,  585.0058],
         [1985.4572,  559.5311],
         [1985.3859,  574.2471],
         [2039.5060,  630.6381],
         [2032.6794,  642.0116]],
        [[2000.2097,  584.9462],
         [1984.4215,  558.3312],
         [1985.2400,  574.1631],
         [2040.8669,  631.8945],
         [2034.0575,  643.2487]],
        [[2000.1234,  584.8877],
         [1983.3844,  557.1264],
         [1985.0983,  574.0811],
         [2042.2346,  633.1504],
         [2035.4396,  644.4877]],
        [[2000.0397,  584.8301],
         [1982.3459,  555.9167],
         [1984.9606,  574.0011],
         [2043.6083,  634.4059],
         [2036.8252,  645.7283]],
        [[1999.9581,  584.7734],
         [1981.3062,  554.7025],
         [1984.8268,  573.9230],
         [2044.9872,  635.6611],
         [2038.2141,  646.9705]],
        [[1999.8789,  584.7177],
         [1980.2651,  553.4837],
         [1984.6968,  573.8468],
         [2046.3707,  636.9163],
         [2039.6061,  648.2142]],
        [[1999.8019,  584.6628],
         [1979.2233,  552.2607],
         [1984.5704,  573.7725],
         [2047.7584,  638.1713],
         [2041.0010,  649.4594]],
        [[1999.7268,  584.6088],
         [1978.1803,  551.0337],
         [1984.4478,  573.7000],
         [2049.1499,  639.4263],
         [2042.3983,  650.7057]],
        [[1999.6538,  584.5554],
         [1977.1365,  549.8027],
         [1984.3285,  573.6294],
         [2050.5449,  640.6815],
         [2043.7981,  651.9532]],
        [[1999.5828,  584.5029],
         [1976.0919,  548.5680],
         [1984.2126,  573.5606],
         [2051.9426,  641.9367],
         [2045.2000,  653.2019]],
        [[1999.5135,  584.4511],
         [1975.0466,  547.3297],
         [1984.1001,  573.4936],
         [2053.3433,  643.1922],
         [2046.6040,  654.4516]],
        [[1999.4460,  584.4000],
         [1974.0007,  546.0880],
         [1983.9907,  573.4283],
         [2054.7463,  644.4479],
         [2048.0098,  655.7022]],
        [[1999.3801,  584.3495],
         [1972.9542,  544.8430],
         [1983.8845,  573.3649],
         [2056.1516,  645.7038],
         [2049.4172,  656.9537]],
        [[1999.3159,  584.2997],
         [1971.9072,  543.5949],
         [1983.7812,  573.3031],
         [2057.5588,  646.9600],
         [2050.8264,  658.2061]],
        [[1999.2533,  584.2505],
         [1970.8597,  542.3439],
         [1983.6810,  573.2430],
         [2058.9680,  648.2165],
         [2052.2371,  659.4593]],
        [[1999.1920,  584.2019],
         [1969.8119,  541.0900],
         [1983.5836,  573.1846],
         [2060.3787,  649.4733],
         [2053.6489,  660.7131]],
        [[1999.1323,  584.1538],
         [1968.7637,  539.8333],
         [1983.4890,  573.1279],
         [2061.7910,  650.7303],
         [2055.0623,  661.9677]],
        [[1999.0739,  584.1063],
         [1967.7152,  538.5741],
         [1983.3971,  573.0728],
         [2063.2046,  651.9877],
         [2056.4766,  663.2228]],
        [[1999.0167,  584.0593],
         [1966.6664,  537.3124],
         [1983.3077,  573.0192],
         [2064.6194,  653.2454],
         [2057.8918,  664.4785]],
        [[1998.9608,  584.0128],
         [1965.6174,  536.0484],
         [1983.2211,  572.9673],
         [2066.0352,  654.5033],
         [2059.3083,  665.7347]],
        [[1998.9061,  583.9667],
         [1964.5682,  534.7821],
         [1983.1368,  572.9169],
         [2067.4521,  655.7615],
         [2060.7256,  666.9915]],
        [[1998.8527,  583.9211],
         [1963.5189,  533.5137],
         [1983.0551,  572.8681],
         [2068.8701,  657.0201],
         [2062.1438,  668.2487]],
        [[1998.8003,  583.8759],
         [1962.4694,  532.2433],
         [1982.9756,  572.8208],
         [2070.2888,  658.2789],
         [2063.5627,  669.5064]],
        [[1998.7489,  583.8311],
         [1961.4198,  530.9709],
         [1982.8984,  572.7750],
         [2071.7083,  659.5379],
         [2064.9824,  670.7644]],
        [[1998.6985,  583.7867],
         [1960.3701,  529.6968],
         [1982.8235,  572.7307],
         [2073.1287,  660.7972],
         [2066.4026,  672.0228]],
        [[1998.6492,  583.7427],
         [1959.3204,  528.4209],
         [1982.7509,  572.6877],
         [2074.5496,  662.0568],
         [2067.8235,  673.2816]],
        [[1998.6007,  583.6991],
         [1958.2708,  527.1434],
         [1982.6802,  572.6463],
         [2075.9709,  663.3165],
         [2069.2451,  674.5407]],
        [[1998.5531,  583.6558],
         [1957.2209,  525.8643],
         [1982.6116,  572.6063],
         [2077.3931,  664.5765],
         [2070.6670,  675.8000]],
        [[1998.5063,  583.6129],
         [1956.1713,  524.5836],
         [1982.5450,  572.5676],
         [2078.8154,  665.8367],
         [2072.0896,  677.0598]],
        [[1998.4606,  583.5702],
         [1955.1215,  523.3016],
         [1982.4805,  572.5304],
         [2080.2385,  667.0970],
         [2073.5125,  678.3196]],
        [[1998.4154,  583.5278],
         [1954.0718,  522.0183],
         [1982.4177,  572.4944],
         [2081.6621,  668.3576],
         [2074.9358,  679.5798]],
        [[1998.3711,  583.4858],
         [1953.0222,  520.7337],
         [1982.3569,  572.4598],
         [2083.0859,  669.6183],
         [2076.3596,  680.8401]],
        [[1998.3274,  583.4440],
         [1951.9727,  519.4479],
         [1982.2979,  572.4266],
         [2084.5100,  670.8793],
         [2077.7837,  682.1007]],
        [[1998.2845,  583.4025],
         [1950.9231,  518.1609],
         [1982.2406,  572.3946],
         [2085.9346,  672.1403],
         [2079.2083,  683.3615]],
        [[1998.2422,  583.3613],
         [1949.8737,  516.8729],
         [1982.1851,  572.3639],
         [2087.3594,  673.4015],
         [2080.6328,  684.6224]],
        [[1998.2006,  583.3203],
         [1948.8243,  515.5839],
         [1982.1311,  572.3344],
         [2088.7847,  674.6628],
         [2082.0579,  685.8835]],
        [[1998.1595,  583.2795],
         [1947.7750,  514.2939],
         [1982.0789,  572.3062],
         [2090.2100,  675.9243],
         [2083.4832,  687.1448]],
        [[1998.1191,  583.2389],
         [1946.7258,  513.0031],
         [1982.0282,  572.2791],
         [2091.6357,  677.1859],
         [2084.9087,  688.4062]],
        [[1998.0792,  583.1985],
         [1945.6769,  511.7114],
         [1981.9790,  572.2532],
         [2093.0615,  678.4476],
         [2086.3345,  689.6677]],
        [[1998.0399,  583.1584],
         [1944.6279,  510.4188],
         [1981.9313,  572.2286],
         [2094.4875,  679.7094],
         [2087.7605,  690.9293]],
        [[1998.0011,  583.1185],
         [1943.5791,  509.1255],
         [1981.8851,  572.2050],
         [2095.9138,  680.9713],
         [2089.1868,  692.1911]],
        [[1997.9628,  583.0787],
         [1942.5304,  507.8315],
         [1981.8403,  572.1826],
         [2097.3403,  682.2332],
         [2090.6130,  693.4529]],
        [[1997.9249,  583.0391],
         [1941.4818,  506.5368],
         [1981.7970,  572.1613],
         [2098.7668,  683.4953],
         [2092.0396,  694.7149]],
        [[1997.8876,  582.9998],
         [1940.4332,  505.2415],
         [1981.7550,  572.1411],
         [2100.1936,  684.7574],
         [2093.4663,  695.9769]],
        [[1997.8506,  582.9605],
         [1939.3849,  503.9456],
         [1981.7142,  572.1220],
         [2101.6206,  686.0197],
         [2094.8931,  697.2391]],
        [[1997.8141,  582.9214],
         [1938.3367,  502.6491],
         [1981.6749,  572.1039],
         [2103.0476,  687.2819],
         [2096.3201,  698.5012]],
        [[1997.7780,  582.8824],
         [1937.2886,  501.3521],
         [1981.6367,  572.0869],
         [2104.4746,  688.5443],
         [2097.7471,  699.7635]],
        [[1997.7422,  582.8437],
         [1936.2406,  500.0546],
         [1981.5997,  572.0709],
         [2105.9019,  689.8067],
         [2099.1741,  701.0259]],
        [[1997.7068,  582.8050],
         [1935.1927,  498.7566],
         [1981.5641,  572.0559],
         [2107.3293,  691.0692],
         [2100.6016,  702.2883]],
        [[1997.6718,  582.7665],
         [1934.1450,  497.4582],
         [1981.5294,  572.0419],
         [2108.7566,  692.3317],
         [2102.0288,  703.5507]],
        [[1997.6371,  582.7281],
         [1933.0974,  496.1594],
         [1981.4960,  572.0288],
         [2110.1843,  693.5942],
         [2103.4563,  704.8132]],
        [[1997.6027,  582.6898],
         [1932.0499,  494.8601],
         [1981.4637,  572.0167],
         [2111.6118,  694.8568],
         [2104.8838,  706.0758]],
        [[1997.5686,  582.6516],
         [1931.0026,  493.5606],
         [1981.4325,  572.0056],
         [2113.0396,  696.1194],
         [2106.3115,  707.3384]],
        [[1997.5349,  582.6136],
         [1929.9553,  492.2607],
         [1981.4022,  571.9953],
         [2114.4673,  697.3821],
         [2107.7393,  708.6010]],
        [[1997.5013,  582.5756],
         [1928.9082,  490.9604],
         [1981.3730,  571.9859],
         [2115.8950,  698.6448],
         [2109.1670,  709.8637]],
        [[1997.4681,  582.5377],
         [1927.8611,  489.6599],
         [1981.3448,  571.9774],
         [2117.3230,  699.9076],
         [2110.5947,  711.1264]]])

distance = []
for a, b in zip(a[:, :], a[1:, :]):
    dist = torch.pairwise_distance(a, b)
    dist = dist.detach().numpy()
    dist = dist.reshape(1, -1)
    distance.append(dist)

distance = np.concatenate(distance, axis=0)
#print(distance)

distance = torch.from_numpy(distance).type(torch.float)
#speed = distance / 0.4
speed = distance
print(torch.sigmoid(speed))


